import functools

import numpy as np

from pandas.compat import is_platform_windows

import pandas as pd


if is_platform_windows():


def cd_and_set_engine(monkeypatch, datapath):
    func = functools.partial(pd.read_excel, engine="odf")
    monkeypatch.setattr(pd, "read_excel", func)
    monkeypatch.chdir(datapath("io", "data", "excel"))


    # the invalid_value_type.ods required manually editing
    # of the included content.xml file
        pd.read_excel("invalid_value_type.ods")


    # (.odt)
    index = pd.Index(["Row 1", "Row 2", "Row 3"], name="Header")
    expected = pd.DataFrame(
        [[1, np.nan, 7], [2, np.nan, 8], [3, np.nan, 9]],
        index=index,
        columns=["Column 1", "Unnamed: 2", "Column 3"],
    )

    result = pd.read_excel("writertable.odt", sheet_name="Table1", index_col=0)

    tm.assert_frame_equal(result, expected)


    # GH#45598
    expected = pd.DataFrame(
        [[1.0, 4.0, 7], [np.nan, np.nan, 8], [3.0, 6.0, 9]],
        columns=["Column 1", "Column 2", "Column 3"],
    )


    tm.assert_frame_equal(result, expected)


    expected = pd.DataFrame(
        [1, np.nan, 3, np.nan, 5],
        columns=["Column 1"],
    )


    tm.assert_frame_equal(result, expected)


    expected = pd.DataFrame(
        columns=["Column 1"],
    )


    tm.assert_frame_equal(result, expected)
